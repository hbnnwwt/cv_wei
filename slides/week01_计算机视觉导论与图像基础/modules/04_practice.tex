%=============================================================================
% æ¨¡å—å››ï¼šæ ¸å¿ƒç®—æ³•ä¸å®æˆ˜æ¼”ç»ƒ
%=============================================================================

\section{å›¾åƒæ»¤é•œåŸç†}

\begin{frame}[fragile]{æ»¤é•œ 1ï¼šç°åº¦åŒ– (Grayscale)}
	\textbf{ä¸ºä»€ä¹ˆè¦ç°åº¦åŒ–ï¼Ÿ}
	\begin{itemize}
		\item å‡å°‘è®¡ç®—é‡ï¼ˆæ•°æ®é‡é™è‡³ 1/3ï¼‰
		\item è¯†åˆ«è¯•å·ä¸Šçš„æ–‡å­—ï¼Œé¢œè‰²ä¿¡æ¯é€šå¸¸æ˜¯ä¸å¿…è¦çš„
	\end{itemize}
	\textbf{åŸç†ï¼š} $Gray = R \times 0.299 + G \times 0.587 + B \times 0.114$
	\\ (ä¸ºä»€ä¹ˆç»¿è‰²æƒé‡æœ€é«˜ï¼Ÿå› ä¸ºäººçœ¼å¯¹ç»¿è‰²æœ€æ•æ„Ÿã€‚)

	\begin{lstlisting}[language=Python, basicstyle=\ttfamily\small]
# æ–¹æ³•1ï¼šOpenCV å‡½æ•°
# TODO 1: ä½¿ç”¨ cv2.cvtColor å°†å½©è‰²å›¾åƒè½¬ä¸ºç°åº¦å›¾
# æç¤ºï¼šå‚æ•°ä¸º cv2.COLOR_BGR2GRAY
gray = cv2.cvtColor(img, __________)

# æ–¹æ³•2ï¼šæ‰‹åŠ¨è®¡ç®—ï¼ˆä¸æ¨èï¼‰
# TODO 2: å¡«å†™æ­£ç¡®çš„æƒé‡ç³»æ•°
# æç¤ºï¼šäººçœ¼å¯¹ç»¿è‰²æœ€æ•æ„Ÿï¼Œç»¿è‰²æƒé‡æœ€å¤§
gray = ____ * r + ____ * g + ____ * b
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]{æ»¤é•œ 2ï¼šåè‰² (Inversion)}
	\textbf{åŸç†ï¼š} $NewValue = 255 - OldValue$
	\begin{itemize}
		\item é»‘è‰² (0) $\to$ ç™½è‰² (255)
		\item ç™½è‰² (255) $\to$ é»‘è‰² (0)
	\end{itemize}
	\textbf{åº”ç”¨ï¼š} å¢å¼ºæš—èƒŒæ™¯ä¸‹çš„è¯•å·ç‰¹å¾ï¼Œæˆ–è€…æ‰«æè´Ÿç‰‡ã€‚

	\begin{lstlisting}[language=Python, basicstyle=\ttfamily\small]
# æ–¹æ³•1ï¼šNumPy è¿ç®—
# TODO 1: å®ç°å›¾åƒåè‰²
# æç¤ºï¼šåè‰²å…¬å¼ NewValue = 255 - OldValue
inverted = ____ - img

# æ–¹æ³•2ï¼šOpenCV ä½è¿ç®—
# TODO 2: ä½¿ç”¨ OpenCV å‡½æ•°å®ç°åè‰²
# æç¤ºï¼šä½¿ç”¨ cv2.bitwise_not
inverted = ________________

# æ–¹æ³•3ï¼šNumPy æŒ‰ä½å–åï¼ˆé€‰åšï¼‰
# TODO 3: ä½¿ç”¨ NumPy æŒ‰ä½å–å
# æç¤ºï¼šä½¿ç”¨ np.bitwise_not
inverted = ________________
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]{æ»¤é•œ 3ï¼šäº®åº¦è°ƒæ•´ä¸"æº¢å‡º"é™·é˜±}
	\textbf{é”™è¯¯åšæ³•ï¼š} \texttt{img + 50}
	\\ å¦‚æœåƒç´ å€¼æ˜¯ 220ï¼ŒåŠ  50 å˜æˆ 270ã€‚è€Œåœ¨ \texttt{uint8} ç±»å‹ä¸‹ï¼Œ270 ä¼šå˜æˆ \highlight{14} (æˆªæ–­/ç»•å›)ï¼Œå¯¼è‡´å›¾åƒå‡ºç°éš¾çœ‹çš„å™ªç‚¹ã€‚

	\begin{lstlisting}[title={å®‰å…¨å†™æ³•}]
# ä½¿ç”¨ numpy çš„ clip å‡½æ•°é™åˆ¶èŒƒå›´
# TODO 1: å®‰å…¨åœ°å¢åŠ äº®åº¦ï¼Œé˜²æ­¢æº¢å‡º
# æç¤ºï¼šå…ˆè½¬ä¸ºint32ï¼ŒåŠ 50åç”¨np.clipé™åˆ¶åˆ°[0,255]ï¼Œå†è½¬å›uint8
bright_img = np.clip(img.astype(np.int32) + ___, ___, ___).astype(______)

# æˆ–è€…ä½¿ç”¨ OpenCV å†…ç½®å‡½æ•°ï¼ˆæ¨èï¼Œé€Ÿåº¦æ›´å¿«ï¼‰
# TODO 2: ä½¿ç”¨ cv2.add å®ç°å®‰å…¨åŠ æ³•
# æç¤ºï¼šcv2.add ä¼šè‡ªåŠ¨å¤„ç†æº¢å‡º
bright_img = cv2.add(img, np.array([______]))
\end{lstlisting}
\end{frame}

% -----------------------------------------------------------------------------
% ä»£ç å®æˆ˜ç¯èŠ‚
% -----------------------------------------------------------------------------

\section{ä»£ç å®æˆ˜}

\begin{frame}[fragile]{ä»£ç å®æˆ˜ï¼ˆ1/5ï¼‰ï¼šå›¾åƒç¿»è½¬ä¸æ—‹è½¬}
	\textbf{åœºæ™¯ï¼š}é˜…å·æ—¶è¯•å·å¯èƒ½è¢«å€’ç½®ï¼Œéœ€è¦è‡ªåŠ¨æ—‹è½¬

	\begin{columns}
		\column{0.5\textwidth}
		\begin{lstlisting}[language=Python, basicstyle=\ttfamily\tiny]
import cv2
import numpy as np

img = cv2.imread('exam.jpg')

# æ–¹æ³•1ï¼šNumPy æ•°ç»„åˆ‡ç‰‡
# TODO 1: å®ç°å‚ç›´ç¿»è½¬ï¼ˆä¸Šä¸‹é¢ å€’ï¼‰
# æç¤ºï¼šä½¿ç”¨åˆ‡ç‰‡ [::-1, :, :] æ¥åè½¬ç¬¬ä¸€ä¸ªç»´åº¦ï¼ˆé«˜åº¦ï¼‰
flip_v = img[____, :, :]

# TODO 2: å®ç°æ°´å¹³ç¿»è½¬ï¼ˆå·¦å³é¢ å€’ï¼‰
# æç¤ºï¼šä½¿ç”¨åˆ‡ç‰‡ [:, ::-1, :] æ¥åè½¬ç¬¬äºŒä¸ªç»´åº¦ï¼ˆå®½åº¦ï¼‰
flip_h = img[:, ____, :]

# TODO 3: å®ç°æ°´å¹³+å‚ç›´ç¿»è½¬ï¼ˆæ—‹è½¬180åº¦ï¼‰
# æç¤ºï¼šåŒæ—¶åè½¬é«˜åº¦å’Œå®½åº¦ä¸¤ä¸ªç»´åº¦
flip_both = img[____, ____, :]
\end{lstlisting}

		\column{0.5\textwidth}
		\begin{lstlisting}[language=Python, basicstyle=\ttfamily\tiny]
# æ–¹æ³•2ï¼šOpenCV å‡½æ•°ï¼ˆæ¨èï¼‰
flip_v = cv2.flip(img, 0)      # å‚ç›´
flip_h = cv2.flip(img, 1)      # æ°´å¹³
flip_both = cv2.flip(img, -1)  # ä¸¤è€…

# æ˜¾ç¤ºå¯¹æ¯”
cv2.imshow('Original', img)
cv2.imshow('Flip V', flip_v)
cv2.imshow('Flip H', flip_h)
cv2.waitKey(0)
\end{lstlisting}
	\end{columns}

	\vspace{0.2cm}
	\textbf{æ€§èƒ½å¯¹æ¯”ï¼š} NumPy åˆ‡ç‰‡æ¯” cv2.flip å¿«çº¦ 20\%ï¼Œä½† cv2.flip æ›´æ˜“è¯»

	\vspace{0.2cm}
	\begin{tcolorbox}[colback=green!5!white,colframe=green!50!black,title=âœ… é¢„æœŸç»“æœ]
		\small
		æˆåŠŸè¿è¡Œåï¼Œåº”çœ‹åˆ°ï¼š
		\begin{itemize}
			\item å››ä¸ªçª—å£åŒæ—¶æ˜¾ç¤ºï¼šåŸå›¾ã€å‚ç›´ç¿»è½¬ã€æ°´å¹³ç¿»è½¬ã€180åº¦æ—‹è½¬
			\item ç¿»è½¬æ•ˆæœæ­£ç¡®ï¼ˆè§‚å¯Ÿæ–‡å­—æ–¹å‘éªŒè¯ï¼‰
			\item ç­‰å¾…æŒ‰é”®åçª—å£å…³é—­
		\end{itemize}
	\end{tcolorbox}
\end{frame}

\begin{frame}[fragile]{ä»£ç å®æˆ˜ï¼ˆ2/5ï¼‰ï¼šæå–ç­”é¢˜å¡åŒºåŸŸï¼ˆROIï¼‰}
	\textbf{åœºæ™¯ï¼š}ä»æ•´å¼ è¯•å·ä¸­æå–ç­”é¢˜å¡åŒºåŸŸ

	\begin{columns}
		\column{0.5\textwidth}
		\begin{lstlisting}[language=Python, basicstyle=\ttfamily\tiny]
import cv2
import numpy as np

exam = cv2.imread('exam.jpg')
h, w = exam.shape[:2]

# å‡è®¾ç­”é¢˜å¡åœ¨å³ä¸‹è§’
# TODO 1: è®¡ç®— ROI çš„åæ ‡èŒƒå›´
# æç¤ºï¼šç­”é¢˜å¡ä½äºå³ä¸‹åŒºåŸŸï¼Œå®½åº¦ä»60%åˆ°æœ«å°¾
x1, x2 = int(w * ______), ___
# æç¤ºï¼šé«˜åº¦ä»50%åˆ°æœ«å°¾
y1, y2 = int(h * ______), ___

# TODO 2: ä½¿ç”¨ NumPy åˆ‡ç‰‡æå– ROI
# æç¤ºï¼šå›¾åƒåˆ‡ç‰‡çš„æ ¼å¼æ˜¯ img[y_start:y_end, x_start:x_end]
roi = exam[____:____, ____:____]

# ä¿å­˜ ROI
cv2.imwrite('answer_sheet.jpg', roi)

print("åŸå›¾å¤§å°:", exam.shape)
print("ROI å¤§å°:", roi.shape)
\end{lstlisting}

		\column{0.5\textwidth}
		\textbf{åæ ‡ç³»ç»Ÿå›é¡¾ï¼š}
		\begin{itemize}
			\item åŸç‚¹åœ¨å·¦ä¸Šè§’ (0, 0)
			\item \texttt{img[y1:y2, x1:x2]}
			\item y æ˜¯è¡Œï¼ˆé«˜åº¦ï¼‰ï¼Œx æ˜¯åˆ—ï¼ˆå®½åº¦ï¼‰
		\end{itemize}

		\vspace{0.3cm}
		\begin{center}
			\begin{tikzpicture}[scale=0.4]
				\draw[thick, fill=blue!10] (0,0) rectangle (6,4);
				\node at (3,2) {æ•´å¼ è¯•å·};
				\draw[thick, fill=red!30] (3.5,0) rectangle (6,2);
				\node at (4.75,1) {\tiny ROI};
				\draw[->] (3.5,2) -- (3.5,3) node[above] {\tiny y1};
				\draw[->] (3.5,0) -- (3.5,-1) node[below] {\tiny y2};
				\draw[->] (3.5,1) -- (2.5,1) node[left] {\tiny x1};
				\draw[->] (6,1) -- (7,1) node[right] {\tiny x2};
			\end{tikzpicture}
		\end{center}
	\end{columns}
\end{frame}

\begin{frame}[fragile]{ä»£ç å®æˆ˜ï¼ˆ3/5ï¼‰ï¼šé€šé“åˆ†ç¦»ä¸åˆå¹¶}
	\textbf{åœºæ™¯ï¼š}æå–ç‰¹å®šé¢œè‰²é€šé“

	\begin{columns}
		\column{0.5\textwidth}
		\begin{lstlisting}[language=Python, basicstyle=\ttfamily\tiny]
import cv2

img = cv2.imread('exam.jpg')

# æ–¹æ³•1ï¼šä½¿ç”¨ split å‡½æ•°
b, g, r = cv2.split(img)

# åªä¿ç•™çº¢è‰²é€šé“ï¼Œå…¶ä»–è®¾ä¸º0
zeros = np.zeros_like(b)
img_r = cv2.merge([zeros, zeros, r])
\end{lstlisting}

		\vspace{0.2cm}
		\begin{lstlisting}[language=Python, basicstyle=\ttfamily\tiny]
# æ–¹æ³•2ï¼šç›´æ¥ç´¢å¼•ï¼ˆæ›´å¿«ï¼‰
img_r = img.copy()
img_r[:, :, 0] = 0  # Bé€šé“
img_r[:, :, 1] = 0  # Gé€šé“
# Ré€šé“ä¿æŒä¸å˜

cv2.imshow('Red Only', img_r)
cv2.waitKey(0)
\end{lstlisting}

		\column{0.5\textwidth}
		\textbf{é€šé“é¡ºåºï¼š}
		\begin{itemize}
			\item OpenCV: \textbf{BGR}
			\item matplotlib: \textbf{RGB}
			\item PIL: \textbf{RGB}
		\end{itemize}

		\vspace{0.3cm}
		\begin{alertblock}{å¸¸è§é”™è¯¯}
			ä½¿ç”¨ \texttt{plt.imshow(img)} æ˜¾ç¤º OpenCV å›¾åƒæ—¶ï¼Œé¢œè‰²ä¼šå¼‚å¸¸ï¼
		\end{alertblock}

		\vspace{0.2cm}
		\textbf{è§£å†³æ–¹æ¡ˆï¼š}
		\begin{lstlisting}[language=Python, basicstyle=\ttfamily\tiny]
img_rgb = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)
plt.imshow(img_rgb)
\end{lstlisting}
	\end{columns}
\end{frame}

\begin{frame}[fragile]{ä»£ç å®æˆ˜ï¼ˆ4/5ï¼‰ï¼šé˜…å·ç³»ç»Ÿæ ¸å¿ƒä»£ç }
	\textbf{åœºæ™¯ï¼š}æ£€æµ‹ç­”é¢˜å¡å¡«æ¶‚ä½ç½®

	\begin{columns}
		\column{0.5\textwidth}
		\begin{lstlisting}[language=Python, basicstyle=\ttfamily\tiny]
import cv2
import numpy as np

# 1. è¯»å–ç­”é¢˜å¡åŒºåŸŸ
roi = cv2.imread('answer_sheet.jpg',
                 cv2.IMREAD_GRAYSCALE)

# 2. äºŒå€¼åŒ–
_, binary = cv2.threshold(roi, 127, 255,
                          cv2.THRESH_BINARY)

# 3. å®šä¹‰é€‰é¡¹ä½ç½®
positions = [
    (100, 100, 120, 120),  # A
    (100, 130, 120, 150),  # B
    (100, 160, 120, 180),  # C
    (100, 190, 120, 200)   # D
]
\end{lstlisting}

		\column{0.5\textwidth}
		\begin{lstlisting}[language=Python, basicstyle=\ttfamily\tiny]
# 4. æ£€æµ‹æ¯ä¸ªé€‰é¡¹æ˜¯å¦è¢«å¡«æ¶‚
answers = []
for (x1, y1, x2, y2) in positions:
    option = binary[y1:y2, x1:x2]

    # è®¡ç®—é»‘è‰²åƒç´ æ¯”ä¾‹
    black_pixels = np.sum(option == 0)
    total_pixels = option.size
    ratio = black_pixels / total_pixels

    # åˆ¤æ–­æ˜¯å¦å¡«æ¶‚ï¼ˆé˜ˆå€¼30%ï¼‰
    if ratio > 0.3:
        answers.append('å¡«æ¶‚')
    else:
        answers.append('æœªå¡«')

print(answers)
\end{lstlisting}
	\end{columns}

	\vspace{0.2cm}
	\textbf{æ ¸å¿ƒæ€æƒ³ï¼š}å¡«æ¶‚åŒºåŸŸé»‘è‰²åƒç´ å æ¯”æ˜¾è‘—é«˜äºæœªå¡«æ¶‚åŒºåŸŸ

	\vspace{0.2cm}
	\begin{tcolorbox}[colback=green!5!white,colframe=green!50!black,title=âœ… é¢„æœŸç»“æœ]
		\small
		æˆåŠŸè¿è¡Œåï¼Œåº”è¾“å‡ºï¼š
		\begin{itemize}
			\item \texttt{['å¡«æ¶‚', 'æœªå¡«', 'æœªå¡«', 'æœªå¡«']} ï¼ˆæˆ–å…¶ä»–æ­£ç¡®çŠ¶æ€ï¼‰
			\item å¡«æ¶‚ä½ç½®çš„ fill\_ratio åº” $>0.6$
			\item æœªå¡«æ¶‚ä½ç½®çš„ fill\_ratio åº” $<0.2$
		\end{itemize}
		\textbf{è°ƒè¯•æç¤ºï¼š} æ‰“å°æ¯ä¸ªé€‰é¡¹çš„ fill\_ratioï¼Œè§‚å¯Ÿæ•°å€¼æ˜¯å¦ç¬¦åˆé¢„æœŸ
	\end{tcolorbox}
\end{frame}

\begin{frame}[fragile]{ä»£ç å®æˆ˜ï¼ˆ5/5ï¼‰ï¼šå›¾åƒå¢å¼ºå¯¹æ¯”}
	\textbf{åœºæ™¯ï¼š}ç­”é¢˜å¡å…‰ç…§ä¸å‡ï¼Œéœ€è¦å¢å¼ºå¯¹æ¯”åº¦

	\begin{columns}
		\column{0.5\textwidth}
		\begin{lstlisting}[language=Python, basicstyle=\ttfamily\tiny]
import cv2
import numpy as np

img = cv2.imread('exam.jpg')

# æ–¹æ³•1ï¼šçº¿æ€§å¯¹æ¯”åº¦è°ƒæ•´
# new = alpha * old + beta
enhanced = cv2.convertScaleAbs(
    img, alpha=1.5, beta=30
)
\end{lstlisting}

		\vspace{0.2cm}
		\begin{lstlisting}[language=Python, basicstyle=\ttfamily\tiny]
# æ–¹æ³•2ï¼šç›´æ–¹å›¾å‡è¡¡åŒ–
gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
equalized = cv2.equalizeHist(gray)
\end{lstlisting}

		\column{0.5\textwidth}
		\begin{lstlisting}[language=Python, basicstyle=\ttfamily\tiny]
# æ–¹æ³•3ï¼šCLAHEï¼ˆè‡ªé€‚åº”ï¼‰
clahe = cv2.createCLAHE(
    clipLimit=2.0,
    tileGridSize=(8,8)
)
enhanced_clahe = clahe.apply(gray)
\end{lstlisting}

		\vspace{0.2cm}
		\textbf{æ•ˆæœå¯¹æ¯”ï¼š}
		\begin{itemize}
			\item \textbf{çº¿æ€§è°ƒæ•´}ï¼šç®€å•ä½†æ•ˆæœæœ‰é™
			\item \textbf{ç›´æ–¹å›¾å‡è¡¡åŒ–}ï¼šå…¨å±€ä¼˜åŒ–
			\item \textbf{CLAHE}ï¼šå±€éƒ¨è‡ªé€‚åº”ï¼Œæ•ˆæœæœ€å¥½
		\end{itemize}

		\vspace{0.2cm}
		\textbf{é˜…å·æ¨èï¼š} CLAHE é€‚åˆå…‰ç…§ä¸å‡åœºæ™¯
	\end{columns}
\end{frame}

% -----------------------------------------------------------------------------
% æŒ‘æˆ˜ä»»åŠ¡
% -----------------------------------------------------------------------------

\begin{frame}{ğŸ¯ æŒ‘æˆ˜ä»»åŠ¡ï¼šæ™ºèƒ½è£å‰ªç­”é¢˜å¡}
	\textbf{ä»»åŠ¡æè¿°ï¼š} ç»™å®šä¸€å¼ è¯•å·ç…§ç‰‡ï¼Œè‡ªåŠ¨è¯†åˆ«å¹¶è£å‰ªå‡ºç­”é¢˜å¡åŒºåŸŸ

	\begin{columns}
		\column{0.5\textwidth}
		\begin{block}{æŒ‘æˆ˜ç›®æ ‡}
			\begin{itemize}
				\item æ‰¾åˆ°ç­”é¢˜å¡å››ä¸ªè§’ç‚¹
				\item é€è§†å˜æ¢çŸ«æ­£
				\item è¾“å‡ºæ ‡å‡†çš„ç­”é¢˜å¡å›¾åƒ
			\end{itemize}
		\end{block}

		\vspace{0.3cm}
		\textbf{æç¤ºï¼š}
		\begin{itemize}
			\item ä½¿ç”¨ \texttt{cv2.Canny} æ£€æµ‹è¾¹ç¼˜
			\item ä½¿ç”¨ \texttt{cv2.findContours} æ‰¾è½®å»“
			\item ä½¿ç”¨ \texttt{cv2.getPerspectiveTransform} é€è§†å˜æ¢
		\end{itemize}

		\column{0.45\textwidth}
		\begin{alertblock}{éš¾åº¦ï¼šâ­â­â­}
			éœ€è¦ç»¼åˆè¿ç”¨ï¼š
			\begin{itemize}
				\item è¾¹ç¼˜æ£€æµ‹
				\item è½®å»“åˆ†æ
				\item å‡ ä½•å˜æ¢
			\end{itemize}
		\end{alertblock}

		\vspace{0.3cm}
		\textbf{é¢„æœŸç»“æœï¼š}
		\begin{itemize}
			\item è¾“å…¥ï¼šä»»æ„è§’åº¦æ‹æ‘„çš„è¯•å·ç…§ç‰‡
			\item è¾“å‡ºï¼šæ­£é¢æœä¸Šçš„ç­”é¢˜å¡å›¾åƒ
			\item æµ‹è¯•ï¼šç”¨è‡ªå·±æ‰‹æœºæ‹çš„è¯•å·éªŒè¯
		\end{itemize}
	\end{columns}
\end{frame}

\begin{frame}[fragile]{ğŸ¯ æŒ‘æˆ˜ä»»åŠ¡ï¼šç­”é¢˜å¡å¡«æ¶‚å¯†åº¦çƒ­å›¾}
	\textbf{ä»»åŠ¡æè¿°ï¼š} å¯è§†åŒ–å…¨ç­ç­”é¢˜å¡æ¯ä¸ªé€‰é¡¹çš„å¡«æ¶‚é¢‘ç‡

	\begin{columns}
		\column{0.55\textwidth}
		\begin{lstlisting}[language=Python, basicstyle=\ttfamily\tiny]
import matplotlib.pyplot as plt
import numpy as np

# å‡è®¾æœ‰å…¨ç­åŒå­¦çš„ç­”é¢˜æ•°æ®
# answers[i][j] è¡¨ç¤ºç¬¬ié¢˜ç¬¬jä¸ªé€‰é¡¹çš„å¡«æ¶‚æ¬¡æ•°
answers = [
    [25, 5, 2, 0],  # ç¬¬1é¢˜ï¼šAæœ€å¤šé€‰
    [3, 20, 8, 1],  # ç¬¬2é¢˜ï¼šBæœ€å¤šé€‰
    # ... æ›´å¤šé¢˜ç›®
]

# TODOï¼šç”Ÿæˆçƒ­å›¾
# 1. è½¬æ¢ä¸ºnumpyæ•°ç»„
data = np.array(answers)

# 2. ä½¿ç”¨plt.imshowæ˜¾ç¤ºçƒ­å›¾
# æç¤ºï¼šä½¿ç”¨cmap='YlOrRd' colormap
plt._______(data, cmap='______')

# 3. æ·»åŠ é¢œè‰²æ¡
plt.________()

# 4. æ·»åŠ é¢˜å·å’Œé€‰é¡¹æ ‡ç­¾
plt.xticks([0,1,2,3], ['A','B','C','D'])
# TODOï¼šæ·»åŠ yè½´æ ‡ç­¾ï¼ˆé¢˜å·ï¼‰
plt.yticks(range(len(data)), [___ for ___ in enumerate(data)])

plt.show()
\end{lstlisting}

		\column{0.4\textwidth}
		\begin{block}{æ•™å­¦ä»·å€¼}
			å¸®åŠ©æ•™å¸ˆå¿«é€Ÿå‘ç°ï¼š
			\begin{itemize}
				\item å“ªäº›é¢˜ç›®å¤ªç®€å•ï¼ˆAé€‰é¡¹90%+ï¼‰
				\item å“ªäº›é¢˜ç›®å¤ªå›°éš¾ï¼ˆåˆ†æ•£åº¦é«˜ï¼‰
				\item è¿·æƒ‘é€‰é¡¹æ˜¯å¦æœ‰æ•ˆï¼ˆB/Cé€‰äº†å¤šå°‘ï¼‰
			\end{itemize}
		\end{block}

		\vspace{0.3cm}
		\textbf{é¢„æœŸç»“æœï¼š}
		\begin{itemize}
			\item çƒ­å›¾æ¸…æ™°å±•ç¤ºå¡«æ¶‚åˆ†å¸ƒ
			\item é¢œè‰²è¶Šçº¢è¡¨ç¤ºå¡«æ¶‚è¶Šå¤š
			\item å¯ç”¨äºæ•™å­¦è´¨é‡åˆ†æ
		\end{itemize}
	\end{columns}

	\vspace{0.2cm}
	\textbf{AIè¾…åŠ©æç¤ºï¼š} å¯ä»¥é—®AIï¼š"matplotlibå¦‚ä½•ç”Ÿæˆçƒ­å›¾å¹¶æ·»åŠ colorbarï¼Ÿ"
\end{frame}

% -----------------------------------------------------------------------------
% å®Œæ•´é˜…å·ç³»ç»ŸLive Coding
% -----------------------------------------------------------------------------

\begin{frame}[fragile]{Live Codingï¼šå®Œæ•´çš„é˜…å·é¢„å¤„ç†æµç¨‹}
	\textbf{ç›®æ ‡ï¼š} ä»ç…§ç‰‡åˆ°å¯è¯†åˆ«çš„å›¾åƒ

	\begin{columns}
		\column{0.5\textwidth}
		\begin{lstlisting}[language=Python, basicstyle=\ttfamily\tiny]
def preprocess_exam(image_path):
    """è¯•å·é¢„å¤„ç†å®Œæ•´æµç¨‹"""

    # 1. è¯»å–å›¾åƒï¼ˆæ”¯æŒä¸­æ–‡è·¯å¾„ï¼‰
    img = imread_chinese(image_path)

    # 2. è½¬ä¸ºç°åº¦
    gray = cv2.cvtColor(img,
                       cv2.COLOR_BGR2GRAY)

    # 3. å»å™ª
    denoised = cv2.GaussianBlur(
        gray, (5, 5), 0)

    # 4. å¯¹æ¯”åº¦å¢å¼ºï¼ˆCLAHEï¼‰
    clahe = cv2.createCLAHE(2.0, (8, 8))
    enhanced = clahe.apply(denoised)

    # 5. äºŒå€¼åŒ–
    binary = cv2.adaptiveThreshold(
        enhanced, 255,
        cv2.ADAPTIVE_THRESH_GAUSSIAN_C,
        cv2.THRESH_BINARY, 11, 2)

    return img, gray, enhanced, binary

# ä½¿ç”¨
img, gray, enhanced, binary = \
    preprocess_exam('exam.jpg')
		\end{lstlisting}

		\column{0.5\textwidth}
		\textbf{æµç¨‹å›¾ï¼š}
		\begin{center}
			\begin{tikzpicture}[scale=0.6, node distance=0.8cm]
				\node[draw, rounded corners] (1) {åŸå›¾};
				\node[draw, rounded corners, below of=1] (2) {ç°åº¦};
				\node[draw, rounded corners, below of=2] (3) {å»å™ª};
				\node[draw, rounded corners, below of=3] (4) {å¢å¼º};
				\node[draw, rounded corners, below of=4] (5) {äºŒå€¼};

				\draw[->] (1) -- (2);
				\draw[->] (2) -- (3);
				\draw[->] (3) -- (4);
				\draw[->] (4) -- (5);
			\end{tikzpicture}
		\end{center}

		\vspace{0.2cm}
		\textbf{å±•ç¤ºç»“æœï¼š}
		\begin{itemize}
			\item åŸå§‹ç…§ç‰‡
			\item é¢„å¤„ç†åå›¾åƒ
			\item å¤„ç†æ—¶é—´å¯¹æ¯”
		\end{itemize}
	\end{columns}
\end{frame}

\begin{frame}[fragile]{Live Codingï¼šé˜…å·ç³»ç»Ÿæ ¸å¿ƒæ£€æµ‹ï¼ˆåŸºç¡€ç‰ˆï¼‰}
	\textbf{åŠŸèƒ½1ï¼šå¡«æ¶‚æ£€æµ‹}
	\begin{lstlisting}[language=Python, basicstyle=\ttfamily\tiny]
def detect_bubble(binary, position):
    """æ£€æµ‹å•ä¸ªæ°”æ³¡çš„å¡«æ¶‚çŠ¶æ€ - åŸºç¡€ç‰ˆ"""
    x1, y1, x2, y2 = position

    # TODO 1: æå–æ°”æ³¡åŒºåŸŸ
    # æç¤ºï¼šä½¿ç”¨NumPyåˆ‡ç‰‡æå–çŸ©å½¢åŒºåŸŸ [y1:y2, x1:x2]
    bubble = binary[____:____, ____:____]

    # TODO 2: è®¡ç®—å¡«æ¶‚å¯†åº¦
    # æç¤ºï¼šé»‘è‰²åƒç´ å€¼ä¸º0ï¼Œç”¨ np.sum(bubble == 0) ç»Ÿè®¡
    black_pixels = _________________
    total_pixels = ________.____
    fill_ratio = black_pixels / total_pixels

    # TODO 3: æ ¹æ®å¡«æ¶‚å¯†åº¦åˆ¤æ–­çŠ¶æ€
    # æç¤ºï¼š>0.6ä¸ºå·²å¡«æ¶‚ï¼Œ<0.2ä¸ºæœªå¡«æ¶‚ï¼Œä¸­é—´ä¸ºä¸ç¡®å®š
    if ______________:
        return 'filled'
    elif _____________:
        return 'empty'
    else:
        return 'uncertain'
	\end{lstlisting}

	\vspace{0.2cm}
	\textbf{åŠŸèƒ½2ï¼šå¤šé€‰æ£€æµ‹ä¸è­¦å‘Šï¼ˆè¿›é˜¶ç‰ˆé€‰åšï¼‰}
	\begin{lstlisting}[language=Python, basicstyle=\ttfamily\tiny]
def detect_multiple_choice(binary, positions):
    """æ£€æµ‹å¤šé€‰å¹¶è­¦å‘Š - è¿›é˜¶ç‰ˆ"""
    results = []

    # TODO 1: éå†æ‰€æœ‰ä½ç½®ï¼Œæ£€æµ‹æ¯ä¸ªæ°”æ³¡çŠ¶æ€
    # æç¤ºï¼šä½¿ç”¨ for å¾ªç¯å’Œä¹‹å‰å®šä¹‰çš„ detect_bubble å‡½æ•°
    for pos in positions:
        state = _________________
        results.append(______)

    # TODO 2: ç»Ÿè®¡å¡«æ¶‚æ•°é‡
    # æç¤ºï¼šä½¿ç”¨ sum å’Œç”Ÿæˆå™¨è¡¨è¾¾å¼ç»Ÿè®¡ 'filled' çš„æ•°é‡
    filled_count = sum(___ for r in results if r == _______)

    # TODO 3: å¦‚æœå¡«æ¶‚æ•°é‡å¤§äº1ï¼Œæ‰“å°å¤šé€‰è­¦å‘Š
    # æç¤ºï¼šä½¿ç”¨ f-string è¾“å‡ºå¡«æ¶‚æ•°é‡
    if filled_count > 1:
        print(f"è­¦å‘Šï¼š______________________")

    return results
	\end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Live Codingï¼šå›¾åƒè´¨é‡æ£€æµ‹å‡½æ•°}
	\textbf{ç›®æ ‡ï¼š} è‡ªåŠ¨åˆ¤æ–­è¯•å·ç…§ç‰‡æ˜¯å¦é€‚åˆè¯†åˆ«

	\begin{columns}
		\column{0.5\textwidth}
		\begin{lstlisting}[language=Python, basicstyle=\ttfamily\tiny]
def check_image_quality(img):
    """æ£€æµ‹å›¾åƒè´¨é‡"""

    h, w = img.shape[:2]

    # 1. åˆ†è¾¨ç‡æ£€æŸ¥
    if min(h, w) < 1000:
        return False, "åˆ†è¾¨ç‡è¿‡ä½"

    # 2. æ›å…‰æ£€æŸ¥
    gray = cv2.cvtColor(img,
                       cv2.COLOR_BGR2GRAY)
    mean_brightness = np.mean(gray)

    if mean_brightness < 80:
        return False, "æ›å…‰ä¸è¶³"
    elif mean_brightness > 200:
        return False, "è¿‡æ›"

    # 3. æ¸…æ™°åº¦æ£€æŸ¥
    laplacian_var = cv2.Laplacian(
        gray, cv2.CV_64F
    ).var()

    if laplacian_var < 100:
        return False, "å›¾åƒæ¨¡ç³Š"

    return True, "è´¨é‡åˆæ ¼"
		\end{lstlisting}

		\column{0.5\textwidth}
		\textbf{ä½¿ç”¨ç¤ºä¾‹ï¼š}
		\begin{lstlisting}[language=Python, basicstyle=\ttfamily\tiny]
img = imread_chinese('exam.jpg')

is_good, msg = check_image_quality(img)

if is_good:
    print(f"å›¾åƒè´¨é‡ï¼š{msg}")
    # ç»§ç»­å¤„ç†
    result = process_image(img)
else:
    print(f"å›¾åƒè´¨é‡ï¼š{msg}")
    print("æç¤ºç”¨æˆ·é‡æ–°æ‹ç…§")
		\end{lstlisting}

		\vspace{0.2cm}
		\textbf{è´¨é‡æ ‡å‡†ï¼š}
		\begin{itemize}
			\item åˆ†è¾¨ç‡ï¼šâ‰¥1000px
			\item æ›å…‰ï¼š80-200
			\item æ¸…æ™°åº¦ï¼šLaplacianæ–¹å·® â‰¥100
		\end{itemize}
	\end{columns}
\end{frame}

\begin{frame}[fragile]{Live Codingï¼šæ‰¹é‡å¤„ç†ä¸ç»“æœè¾“å‡º}
	\textbf{æ‰¹é‡å¤„ç†å‡½æ•°ï¼š}
	\begin{lstlisting}[language=Python, basicstyle=\ttfamily\tiny]
import os
import json

def batch_process_exams(folder_path, output_path):
    """æ‰¹é‡å¤„ç†è¯•å·"""
    results = []

    for filename in os.listdir(folder_path):
        if not filename.endswith(('.jpg', '.png')):
            continue

        input_path = os.path.join(folder_path, filename)

        # 1. è´¨é‡æ£€æŸ¥
        is_good, msg = check_image_quality(
            imread_chinese(input_path))
        if not is_good:
            print(f"X {filename}: {msg}")
            continue

        # 2. é¢„å¤„ç†
        img, gray, enhanced, binary = \
            preprocess_exam(input_path)

        # 3. æ£€æµ‹ç­”é¢˜
        answers = detect_all_answers(binary)

        # 4. è¯„åˆ†
        score, details = grade_answers(answers)

        # 5. ä¿å­˜ç»“æœ
        result = {
            'filename': filename,
            'score': score,
            'details': details,
            'quality': is_good
        }
        results.append(result)

        print(f"OK {filename}: {score}åˆ†")

    # ä¿å­˜åˆ°JSON
    with open(output_path, 'w', encoding='utf-8') as f:
        json.dump(results, f, ensure_ascii=False, indent=2)

    return results
	\end{lstlisting}
\end{frame}
